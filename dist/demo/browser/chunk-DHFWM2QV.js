import{a as W,b as T,c as I,d as B,e as N,f as H,g as z,h as D,i as j,j as U,k as G,l as Z,m as Y}from"./chunk-URCBRLE2.js";import{a as J}from"./chunk-2Z2EG4HP.js";import"./chunk-PXISLNCC.js";import{$ as O,C as V,D as o,F as S,G as E,K as v,O as u,P as t,Q as i,R as C,S as A,T as w,U as M,V as q,Z as l,_ as k,ba as f,c as P,ca as h,da as _,la as R,ma as F,sa as L,u as s,v as g,w as x,x as y}from"./chunk-SK7NGN37.js";function K(d,p){d&1&&(t(0,"span"),l(1,"Choose Image"),i())}function Q(d,p){if(d&1&&(t(0,"span"),l(1),i()),d&2){let b=M();o(),k(b.selectedFileName)}}function X(d,p){if(d&1){let b=A();t(0,"div",44),C(1,"img",45),t(2,"button",46),w("click",function(){s(b);let r=M();return g(r.removeImage())}),x(),t(3,"svg",47),C(4,"path",48),i()()()}if(d&2){let b=M();o(),u("src",b.imagePreview,V)}}function $(d,p){d&1&&(t(0,"span"),l(1,"Adding..."),i())}function ee(d,p){d&1&&(t(0,"span"),l(1,"Add Animal"),i())}function te(d,p){if(d&1&&(t(0,"div",49),l(1),i()),d&2){let b=M();o(),O(" ",b.errorMessage," ")}}var me=(()=>{let p=class p{constructor(m,r){this.animalService=m,this.router=r,this.animalRequest={name:"",breed:"",weight:0,birthdate:new Date,barn:"",location:"",campaign:"",gender:"female",imageUrl:""},this.birthdateString="",this.loading=!1,this.errorMessage="",this.selectedFileName="",this.imagePreview=null,this.selectedFile=null}onFileSelected(m){let r=m.target.files[0];if(r){this.selectedFile=r,this.selectedFileName=r.name;let e=new FileReader;e.onload=a=>{this.imagePreview=a.target.result},e.readAsDataURL(r)}}removeImage(){this.selectedFile=null,this.selectedFileName="",this.imagePreview=null,this.animalRequest.imageUrl="";let m=document.getElementById("imageFile");m&&(m.value="")}convertFileToBase64(m){return new Promise((r,e)=>{let a=new FileReader;a.onload=()=>r(a.result),a.onerror=e,a.readAsDataURL(m)})}onSubmit(){return P(this,null,function*(){if(!this.loading){if(!this.selectedFile){this.errorMessage="Please select an image for the animal.";return}this.birthdateString&&(this.animalRequest.birthdate=new Date(this.birthdateString)),this.loading=!0,this.errorMessage="";try{let m=yield this.convertFileToBase64(this.selectedFile);this.animalRequest.imageUrl=m,this.animalService.createAnimal(this.animalRequest).subscribe({next:r=>{this.loading=!1,this.router.navigate(["/animals",r.id])},error:r=>{this.loading=!1,this.errorMessage=r.message||"Failed to add animal. Please try again.",console.error("Error creating animal:",r)}})}catch(m){this.loading=!1,this.errorMessage="Failed to process the image. Please try again.",console.error("Error processing image:",m)}}})}goBack(){this.router.navigate(["/animals"])}};p.\u0275fac=function(r){return new(r||p)(S(J),S(L))},p.\u0275cmp=E({type:p,selectors:[["app-add-animal"]],decls:70,vars:16,consts:[["animalForm","ngForm"],["fileInput",""],[1,"add-animal-container"],[1,"add-animal-content","fade-in"],[1,"add-header"],[1,"back-button",3,"click"],["width","24","height","24","viewBox","0 0 24 24","fill","currentColor"],["d","M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"],[1,"add-title"],[1,"add-form-card"],[3,"ngSubmit"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","breed"],["type","text","id","breed","name","breed","required","",1,"form-input",3,"ngModelChange","ngModel"],[1,"form-row"],["for","weight"],["type","number","id","weight","name","weight","required","","min","1",1,"form-input",3,"ngModelChange","ngModel"],["for","gender"],["id","gender","name","gender","required","",1,"form-input",3,"ngModelChange","ngModel"],["value",""],["value","female"],["value","male"],["for","birthdate"],["type","date","id","birthdate","name","birthdate","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","barn"],["type","text","id","barn","name","barn","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","location"],["type","text","id","location","name","location","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","campaign"],["type","text","id","campaign","name","campaign","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","imageFile"],[1,"file-input-container"],["type","file","id","imageFile","accept","image/*",1,"file-input",3,"change"],["for","imageFile",1,"file-input-label"],["width","20","height","20","viewBox","0 0 24 24","fill","currentColor"],["d","M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"],[4,"ngIf"],["class","image-preview",4,"ngIf"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","error-message",4,"ngIf"],[1,"image-preview"],["alt","Preview",3,"src"],["type","button",1,"remove-image",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","currentColor"],["d","M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"],[1,"error-message"]],template:function(r,e){if(r&1){let a=A();t(0,"div",2)(1,"div",3)(2,"div",4)(3,"button",5),w("click",function(){return s(a),g(e.goBack())}),x(),t(4,"svg",6),C(5,"path",7),i()(),y(),t(6,"h1",8),l(7,"Add New Animal"),i()(),t(8,"div",9)(9,"form",10,0),w("ngSubmit",function(){return s(a),g(e.onSubmit())}),t(11,"div",11)(12,"label",12),l(13,"Name *"),i(),t(14,"input",13),_("ngModelChange",function(n){return s(a),h(e.animalRequest.name,n)||(e.animalRequest.name=n),g(n)}),i()(),t(15,"div",11)(16,"label",14),l(17,"Breed *"),i(),t(18,"input",15),_("ngModelChange",function(n){return s(a),h(e.animalRequest.breed,n)||(e.animalRequest.breed=n),g(n)}),i()(),t(19,"div",16)(20,"div",11)(21,"label",17),l(22,"Weight (kg) *"),i(),t(23,"input",18),_("ngModelChange",function(n){return s(a),h(e.animalRequest.weight,n)||(e.animalRequest.weight=n),g(n)}),i()(),t(24,"div",11)(25,"label",19),l(26,"Gender *"),i(),t(27,"select",20),_("ngModelChange",function(n){return s(a),h(e.animalRequest.gender,n)||(e.animalRequest.gender=n),g(n)}),t(28,"option",21),l(29,"Select gender"),i(),t(30,"option",22),l(31,"Female"),i(),t(32,"option",23),l(33,"Male"),i()()()(),t(34,"div",11)(35,"label",24),l(36,"Birth Date *"),i(),t(37,"input",25),_("ngModelChange",function(n){return s(a),h(e.birthdateString,n)||(e.birthdateString=n),g(n)}),i()(),t(38,"div",16)(39,"div",11)(40,"label",26),l(41,"Barn *"),i(),t(42,"input",27),_("ngModelChange",function(n){return s(a),h(e.animalRequest.barn,n)||(e.animalRequest.barn=n),g(n)}),i()(),t(43,"div",11)(44,"label",28),l(45,"Location *"),i(),t(46,"input",29),_("ngModelChange",function(n){return s(a),h(e.animalRequest.location,n)||(e.animalRequest.location=n),g(n)}),i()()(),t(47,"div",11)(48,"label",30),l(49,"Campaign *"),i(),t(50,"input",31),_("ngModelChange",function(n){return s(a),h(e.animalRequest.campaign,n)||(e.animalRequest.campaign=n),g(n)}),i()(),t(51,"div",11)(52,"label",32),l(53,"Animal Photo *"),i(),t(54,"div",33)(55,"input",34,1),w("change",function(n){return s(a),g(e.onFileSelected(n))}),i(),t(57,"label",35),x(),t(58,"svg",36),C(59,"path",37),i(),v(60,K,2,0,"span",38)(61,Q,2,1,"span",38),i()(),v(62,X,5,1,"div",39),i(),y(),t(63,"div",40)(64,"button",41),w("click",function(){return s(a),g(e.goBack())}),l(65," Cancel "),i(),t(66,"button",42),v(67,$,2,0,"span",38)(68,ee,2,0,"span",38),i()()(),v(69,te,2,1,"div",43),i()()()}if(r&2){let a=q(10);o(14),f("ngModel",e.animalRequest.name),o(4),f("ngModel",e.animalRequest.breed),o(5),f("ngModel",e.animalRequest.weight),o(4),f("ngModel",e.animalRequest.gender),o(10),f("ngModel",e.birthdateString),o(5),f("ngModel",e.animalRequest.barn),o(4),f("ngModel",e.animalRequest.location),o(4),f("ngModel",e.animalRequest.campaign),o(10),u("ngIf",!e.selectedFileName),o(),u("ngIf",e.selectedFileName),o(),u("ngIf",e.imagePreview),o(2),u("disabled",e.loading),o(2),u("disabled",e.loading||a.invalid||!e.selectedFile),o(),u("ngIf",e.loading),o(),u("ngIf",!e.loading),o(),u("ngIf",e.errorMessage)}},dependencies:[F,R,Y,H,j,U,W,z,D,T,I,Z,G,N,B],styles:[".add-animal-container[_ngcontent-%COMP%]{min-height:100vh;background:var(--light-gray);padding:20px}.add-animal-content[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}.add-header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:30px;padding-top:20px}.back-button[_ngcontent-%COMP%]{background:var(--white);border:none;border-radius:12px;width:48px;height:48px;display:flex;align-items:center;justify-content:center;cursor:pointer;margin-right:20px;transition:var(--transition);color:var(--dark-green);box-shadow:0 2px 8px #0000001a}.back-button[_ngcontent-%COMP%]:hover{transform:translate(-2px);box-shadow:0 4px 12px #00000026}.add-title[_ngcontent-%COMP%]{color:var(--dark-green);font-size:28px;font-weight:700;margin:0}.add-form-card[_ngcontent-%COMP%]{background:var(--white);border-radius:20px;padding:30px;box-shadow:0 10px 30px #0000001a}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}label[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:600;color:var(--text-dark);margin-bottom:8px}.form-input[_ngcontent-%COMP%]{width:100%;padding:16px 20px;border:2px solid #e0e0e0;border-radius:var(--border-radius);background-color:var(--white);font-size:16px;color:var(--text-dark);transition:var(--transition)}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--dark-green);transform:translateY(-1px)}select.form-input[_ngcontent-%COMP%]{cursor:pointer}.form-actions[_ngcontent-%COMP%]{display:flex;gap:15px;margin-top:30px;justify-content:flex-end}.btn[_ngcontent-%COMP%]{padding:14px 28px;font-size:16px;font-weight:600;min-width:120px}.file-input-container[_ngcontent-%COMP%]{position:relative}.file-input[_ngcontent-%COMP%]{position:absolute;opacity:0;width:100%;height:100%;cursor:pointer}.file-input-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:16px 20px;border:2px dashed #e0e0e0;border-radius:var(--border-radius);background-color:var(--light-gray);cursor:pointer;transition:var(--transition);color:#666;font-size:16px}.file-input-label[_ngcontent-%COMP%]:hover{border-color:var(--dark-green);background-color:#f0f0f0;color:var(--dark-green)}.image-preview[_ngcontent-%COMP%]{margin-top:15px;position:relative;display:inline-block}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-width:200px;height:150px;object-fit:cover;border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a}.remove-image[_ngcontent-%COMP%]{position:absolute;top:-8px;right:-8px;background:#ff4757;color:#fff;border:none;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:var(--transition)}.remove-image[_ngcontent-%COMP%]:hover{background:#ff3742;transform:scale(1.1)}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:12px;border-radius:8px;margin-top:20px;text-align:center;font-size:14px}@media (max-width: 600px){.add-animal-container[_ngcontent-%COMP%]{padding:15px}.add-form-card[_ngcontent-%COMP%]{padding:20px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:0}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}"]});let d=p;return d})();export{me as AddAnimalComponent};
