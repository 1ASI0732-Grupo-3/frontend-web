import{a as l}from"./chunk-FYZU2BPS.js";import{a as T}from"./chunk-JJHZGF76.js";import{a as m}from"./chunk-UX2XIPUK.js";import{a as P}from"./chunk-HGCZPB4I.js";import{a as E}from"./chunk-NXIFL3PH.js";import{a as k}from"./chunk-QHWG3LQQ.js";import{a as S,b as F}from"./chunk-6PRDA76Z.js";import{a as x}from"./chunk-PXISLNCC.js";import{A as D,G as R,R as L,a as g,b as U,g as i,h as M,i as c,k as s,l as p,ma as $,na as O,oa as A,p as d,pa as B,ra as j,s as f,sa as N,t as C,va as V}from"./chunk-SK7NGN37.js";var u=()=>{let o=C(F),a=C(N);return o.isAuthenticated()?!0:a.createUrlTree(["/auth/login"])},G=()=>{let o=C(F),a=C(N);return o.isAuthenticated()?a.createUrlTree(["/dashboard"]):!0},H=[{path:"",redirectTo:"/auth/login",pathMatch:"full"},{path:"auth/login",loadComponent:()=>import("./chunk-RCEAFWST.js").then(o=>o.LoginComponent),canActivate:[G]},{path:"auth/register",loadComponent:()=>import("./chunk-VGVNZ2DS.js").then(o=>o.RegisterComponent),canActivate:[G]},{path:"plans",loadComponent:()=>import("./chunk-W3OCY5QA.js").then(o=>o.PlansComponent)},{path:"dashboard",loadComponent:()=>import("./chunk-NTN5P7QP.js").then(o=>o.DashboardComponent),canActivate:[u]},{path:"animals",loadComponent:()=>import("./chunk-EKY3MYIF.js").then(o=>o.AnimalsComponent),canActivate:[u]},{path:"animals/new",loadComponent:()=>import("./chunk-DHFWM2QV.js").then(o=>o.AddAnimalComponent),canActivate:[u]},{path:"animals/:id",loadComponent:()=>import("./chunk-3WP5MCQD.js").then(o=>o.AnimalDetailComponent),canActivate:[u]},{path:"campaigns",loadComponent:()=>import("./chunk-SDO5UF3V.js").then(o=>o.CampaignsComponent),canActivate:[u]},{path:"campaigns/new",loadComponent:()=>import("./chunk-LNZQ4YTW.js").then(o=>o.AddCampaignComponent),canActivate:[u]},{path:"campaigns/:id",loadComponent:()=>import("./chunk-4PEGTWUW.js").then(o=>o.CampaignDetailComponent),canActivate:[u]},{path:"inventory",loadComponent:()=>import("./chunk-OGFCY32E.js").then(o=>o.InventoryComponent),canActivate:[u]},{path:"inventory/products",loadComponent:()=>import("./chunk-F264HUDY.js").then(o=>o.InventoryProductsComponent),canActivate:[u]},{path:"inventory/add-product",loadComponent:()=>import("./chunk-YELZEOJP.js").then(o=>o.AddInventoryProductComponent),canActivate:[u]},{path:"settings",loadComponent:()=>import("./chunk-NTN5P7QP.js").then(o=>o.DashboardComponent),canActivate:[u]},{path:"**",redirectTo:"/auth/login"}];var b=function(o){return o.ADMIN="admin",o.VETERINARIAN="veterinarian",o.ASSISTANT="assistant",o}(b||{});var v={apiUrl:"https://vacapp-api-platform-app-202.jollypebble-386b7d46.westus3.azurecontainerapps.io/api/v1"};var z=(()=>{let a=class a extends S{constructor(t){super(),this.http=t,this.baseUrl=v.apiUrl}login(t){let e={email:t.email,password:t.password};return this.http.post(`${this.baseUrl}/user/sign-in`,e).pipe(c(r=>({token:r.token||r.accessToken,user:{username:r.username||r.user?.username||"",name:r.username||r.user?.username||"",email:r.email||r.user?.email||t.email,emailConfirmed:r.emailConfirmed||r.user?.emailConfirmed||!1,id:r.id||r.user?.id||"1",role:b.VETERINARIAN,createdAt:new Date}})),s(r=>(console.error("Login error:",r),M(()=>new Error("Invalid credentials")))))}register(t){let e={username:t.name,email:t.email,password:t.password};return this.http.post(`${this.baseUrl}/user/sign-up`,e).pipe(c(r=>({token:r.token||r.accessToken,user:{username:r.username||e.username,name:r.username||e.username,email:r.email||e.email,emailConfirmed:r.emailConfirmed||!1,id:r.id||"1",role:b.VETERINARIAN,createdAt:new Date}})),s(r=>(console.error("Registration error:",r),M(()=>new Error("Registration failed")))))}logout(){return localStorage.removeItem("auth_token"),localStorage.removeItem("user_info"),i(void 0)}getCurrentUser(){return localStorage.getItem("auth_token")?this.http.get(`${this.baseUrl}/user/get-info`).pipe(c(e=>({username:e.name||"",name:e.name||"",email:e.email||"",emailConfirmed:!0,id:e.id||"1",role:b.VETERINARIAN,createdAt:new Date})),s(e=>{console.error("Get user info error:",e);let r=localStorage.getItem("user_info");return r?i(JSON.parse(r)):i(null)})):i(null)}getUserInfo(){return this.http.get(`${this.baseUrl}/user/get-info`)}};a.\u0275fac=function(e){return new(e||a)(f(A))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var I=function(o){return o.VACCINATION="vaccination",o.DEWORMING="deworming",o.CAMPAIGN="campaign",o}(I||{});var J=(()=>{let a=class a extends k{getStats(){return i({registeredAnimals:123,campaigns:4,employees:32,vaccinesAboutToExpire:10,activeCampaigns:6}).pipe(p(500))}getUpcomingEvents(){let t=[{id:"1",title:"Foot and Mouth Disease Vaccination",date:"10-May",type:I.VACCINATION},{id:"2",title:"Internal and External Deworming",date:"05-July",type:I.DEWORMING},{id:"3",title:"Brucellosis Sanitation Campaign",date:"23-August",type:I.CAMPAIGN}];return i(t).pipe(p(500))}};a.\u0275fac=(()=>{let t;return function(r){return(t||(t=D(a)))(r||a)}})(),a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var Y=(()=>{let a=class a extends E{getPlans(){return i([{id:"free",name:"Free",price:0,currency:"S/",features:["Registro de hasta 10 animales.","Acceso b\xE1sico al historial sanitario.","Recordatorios limitados.","Visualizaci\xF3n de reportes mensuales en formato simple.","Soporte por correo electr\xF3nico."]},{id:"premium",name:"Premium",price:49.9,currency:"S/",features:["Registro ilimitado de animales.","Seguimiento completo de salud y vacunaci\xF3n.","Gesti\xF3n de inventario y productos.","Soporte prioritario."],isPopular:!0}]).pipe(p(500))}subscribeToPlan(t){return console.log(`Subscribing to plan: ${t}`),i(!0).pipe(p(1e3))}};a.\u0275fac=(()=>{let t;return function(r){return(t||(t=D(a)))(r||a)}})(),a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var K=(()=>{let a=class a extends x{constructor(t){super(),this.http=t,this.baseUrl=v.apiUrl}getAnimals(){return this.http.get(`${this.baseUrl}/bovines`).pipe(c(t=>t.map(e=>this.mapApiAnimalToAnimal(e))),s(t=>(console.error("Error fetching animals:",t),i([]))))}getAnimalById(t){return this.http.get(`${this.baseUrl}/bovines/${t}`).pipe(c(e=>this.mapApiAnimalToAnimal(e)),s(e=>{throw console.error("Error fetching animal:",e),e}))}createAnimal(t){let e=new FormData;return e.append("Name",t.name),e.append("Gender",t.gender),e.append("BirthDate",t.birthdate.toISOString()),e.append("Breed",t.breed),e.append("Location",t.location),e.append("StableId","1"),t.imageUrl,this.http.post(`${this.baseUrl}/bovines`,e).pipe(c(r=>({id:r.id,name:r.name,breed:r.breed,gender:r.gender,location:r.location,birthDate:r.birthDate,birthdate:new Date(r.birthDate),bovineImg:r.bovineImg,imageUrl:r.bovineImg,stableId:r.stableId,weight:t.weight,campaign:t.campaign,barn:t.barn,age:this.calculateAge(r.birthDate),createdAt:new Date})),s(r=>{throw console.error("Error creating animal:",r),r}))}updateAnimal(t,e){let r=new FormData;return e.name&&r.append("Name",e.name),e.gender&&r.append("Gender",e.gender),e.breed&&r.append("Breed",e.breed),e.location&&r.append("Location",e.location),e.stableId&&r.append("StableId",e.stableId.toString()),this.http.put(`${this.baseUrl}/bovines/${t}`,r).pipe(c(n=>this.mapApiAnimalToAnimal(n)),s(n=>{throw console.error("Error updating animal:",n),n}))}deleteAnimal(t){return this.http.delete(`${this.baseUrl}/bovines/${t}`).pipe(s(e=>{throw console.error("Error deleting animal:",e),e}))}getAnimalsByStable(t){return this.http.get(`${this.baseUrl}/bovines/stable/${t}`).pipe(s(e=>(console.error("Error fetching animals by stable:",e),i([]))))}getVaccinations(t){return this.http.get(`${this.baseUrl}/vaccines/bovine/${t}`).pipe(s(e=>(console.error("Error fetching vaccinations:",e),i([]))))}getStables(){return this.http.get(`${this.baseUrl}/stables`).pipe(s(t=>(console.error("Error fetching stables:",t),i([]))))}mapApiAnimalToAnimal(t){return{id:t.id,name:t.name,breed:t.breed,gender:t.gender,location:t.location,birthDate:t.birthDate,birthdate:new Date(t.birthDate),bovineImg:t.bovineImg,imageUrl:t.bovineImg||"",stableId:t.stableId,weight:500,campaign:"General",barn:"Establo General",age:this.calculateAge(t.birthDate),createdAt:new Date}}calculateAge(t){let e=new Date,r=new Date(t),n=e.getFullYear()-r.getFullYear(),h=e.getMonth()-r.getMonth();return(h<0||h===0&&e.getDate()<r.getDate())&&n--,Math.max(0,n)}};a.\u0275fac=function(e){return new(e||a)(f(A))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var Q=(()=>{let a=class a extends T{constructor(t){super(),this.http=t,this.baseUrl=v.apiUrl,this.mockCampaigns=[{id:1,name:"Bovine Brucellosis",description:"Cattle vaccination",startDate:new Date("2025-05-09"),endDate:new Date("2025-06-20"),status:l.ACTIVE,targetAnimals:["cattle","bovine"],vaccineType:"Brucellosis Vaccine",createdAt:new Date("2025-05-01"),updatedAt:new Date("2025-05-09")},{id:2,name:"Foot-and-Mouth Disease",description:"Cattle vaccination",startDate:new Date("2025-05-09"),endDate:new Date("2025-06-20"),status:l.ACTIVE,targetAnimals:["cattle","livestock"],vaccineType:"FMD Vaccine",createdAt:new Date("2025-05-01"),updatedAt:new Date("2025-05-09")},{id:3,name:"Healthy Herd 2025",description:"Cattle vaccination",startDate:new Date("2025-05-09"),endDate:new Date("2025-06-20"),status:l.SCHEDULED,targetAnimals:["cattle","livestock"],vaccineType:"Multi-vaccine Protocol",createdAt:new Date("2025-05-01"),updatedAt:new Date("2025-05-09")},{id:4,name:"Winter Deworming Campaign",description:"Comprehensive deworming program",startDate:new Date("2025-03-15"),endDate:new Date("2025-04-30"),status:l.COMPLETED,targetAnimals:["cattle","sheep","goats"],vaccineType:"Antiparasitic Treatment",createdAt:new Date("2025-03-01"),updatedAt:new Date("2025-04-30")}]}getCampaigns(){return this.http.get(`${this.baseUrl}/campaigns`).pipe(c(t=>t.map(e=>this.mapApiCampaignToCampaign(e))),s(t=>(console.error("Error fetching campaigns:",t),i([...this.mockCampaigns]))))}getCampaignById(t){return this.http.get(`${this.baseUrl}/campaigns/${t}`).pipe(c(e=>this.mapApiCampaignToCampaign(e)),s(e=>{throw console.error("Error fetching campaign:",e),e}))}createCampaign(t){let e={name:t.name,description:t.description,startDate:t.startDate.toISOString(),endDate:t.endDate.toISOString(),status:this.determineStatus(t.startDate,t.endDate),goals:[],channels:[],stableId:void 0};return this.http.post(`${this.baseUrl}/campaigns`,e).pipe(c(r=>this.mapApiCampaignToCampaign(r)),s(r=>{throw console.error("Error creating campaign:",r),r}))}updateCampaign(t,e){let r=g({},e);return e.startDate&&(r.startDate=e.startDate.toISOString()),e.endDate&&(r.endDate=e.endDate.toISOString()),this.http.put(`${this.baseUrl}/campaigns/${t}`,r).pipe(c(n=>this.mapApiCampaignToCampaign(n)),s(n=>{throw console.error("Error updating campaign:",n),n}))}deleteCampaign(t){return this.http.delete(`${this.baseUrl}/campaigns/${t}`).pipe(s(e=>{throw console.error("Error deleting campaign:",e),e}))}getActiveCampaigns(){return this.getCampaigns().pipe(c(t=>t.filter(e=>e.status===l.ACTIVE)))}getCompletedCampaigns(){return this.getCampaigns().pipe(c(t=>t.filter(e=>e.status===l.COMPLETED)))}mapApiCampaignToCampaign(t){return{id:t.id,name:t.name,description:t.description,startDate:new Date(t.startDate),endDate:new Date(t.endDate),status:this.mapApiStatus(t.status),targetAnimals:t.targetAnimals||[],vaccineType:t.vaccineType,createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt?new Date(t.updatedAt):new Date,goals:t.goals||[],channels:t.channels||[],stableId:t.stableId}}mapApiStatus(t){switch(t?.toLowerCase()){case"active":return l.ACTIVE;case"completed":return l.COMPLETED;case"scheduled":return l.SCHEDULED;case"cancelled":return l.CANCELLED;default:return l.SCHEDULED}}determineStatus(t,e){let r=new Date,n=new Date(t),h=new Date(e);return r<n?"scheduled":r>=n&&r<=h?"active":"completed"}};a.\u0275fac=function(e){return new(e||a)(f(A))},a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var X=(()=>{let a=class a extends P{constructor(){super(...arguments),this.products=[{id:"1",name:"Fiebre Aftosa (Oleosa)",category:m.MEDICINES,stock:2,expirationDate:new Date("2025-12-15"),minStockLevel:5,createdAt:new Date("2025-01-01"),updatedAt:new Date("2025-01-01")},{id:"2",name:"Oxitetraciclina",category:m.VACCINES,stock:5,expirationDate:new Date("2025-11-20"),minStockLevel:10,createdAt:new Date("2025-01-02"),updatedAt:new Date("2025-01-02")},{id:"3",name:"Brucelosis (RB51)",category:m.VACCINES,stock:13,expirationDate:new Date("2025-10-25"),minStockLevel:10,createdAt:new Date("2025-01-03"),updatedAt:new Date("2025-01-03")},{id:"4",name:"Ketoprofeno",category:m.MEDICINES,stock:25,expirationDate:new Date("2026-06-18"),minStockLevel:10,createdAt:new Date("2025-01-04"),updatedAt:new Date("2025-01-04")},{id:"5",name:"Ivermectina 1%",category:m.MEDICINES,stock:8,expirationDate:new Date("2026-07-05"),minStockLevel:15,createdAt:new Date("2025-01-05"),updatedAt:new Date("2025-01-05")},{id:"6",name:"Clostridiates (8 vias)",category:m.VACCINES,stock:12,expirationDate:new Date("2026-07-23"),minStockLevel:8,createdAt:new Date("2025-01-06"),updatedAt:new Date("2025-01-06")},{id:"7",name:"Fiebre Aftosa (Oleosa)",category:m.FOOD,stock:2,expirationDate:new Date("2025-12-15"),minStockLevel:5,createdAt:new Date("2025-01-07"),updatedAt:new Date("2025-01-07")},{id:"8",name:"Oxitetraciclina",category:m.SUPPLEMENTS,stock:5,expirationDate:new Date("2025-11-20"),minStockLevel:10,createdAt:new Date("2025-01-08"),updatedAt:new Date("2025-01-08")},{id:"9",name:"Brucelosis (RB51)",category:m.FOOD,stock:13,expirationDate:new Date("2025-10-25"),minStockLevel:10,createdAt:new Date("2025-01-09"),updatedAt:new Date("2025-01-09")}],this.categoryColors={[m.MEDICINES]:"#FFD93D",[m.VACCINES]:"#FF6B6B",[m.FOOD]:"#A8E6CF",[m.SUPPLEMENTS]:"#DDA0DD"}}getProducts(){return i([...this.products]).pipe(p(500))}getProductById(t){let e=this.products.find(r=>r.id===t);if(!e)throw new Error(`Product with id ${t} not found`);return i(g({},e)).pipe(p(300))}createProduct(t){let e=U(g({id:Math.random().toString(36).substr(2,9)},t),{minStockLevel:t.minStockLevel||10,createdAt:new Date,updatedAt:new Date});return this.products.push(e),i(g({},e)).pipe(p(800))}updateProduct(t,e){let r=this.products.findIndex(n=>n.id===t);if(r===-1)throw new Error(`Product with id ${t} not found`);return this.products[r]=U(g(g({},this.products[r]),e),{updatedAt:new Date}),i(g({},this.products[r])).pipe(p(500))}deleteProduct(t){let e=this.products.findIndex(r=>r.id===t);if(e===-1)throw new Error(`Product with id ${t} not found`);return this.products.splice(e,1),i(void 0).pipe(p(400))}getInventoryStats(){let t=this.products.reduce((y,Z)=>y+Z.stock,0),e=this.products.filter(y=>y.stock<=y.minStockLevel).length,r=this.getExpiringSoonCount(),n=Object.keys(m).length;return i({totalStoredProducts:t,lowStockProducts:e,expiringSoonProducts:r,totalCategories:n}).pipe(p(400))}getProductsByCategory(){let t={};this.products.forEach(n=>{t[n.category]=(t[n.category]||0)+1});let e=this.products.length,r=Object.entries(t).map(([n,h])=>({category:n,count:h,percentage:Math.round(h/e*100),color:this.categoryColors[n]}));return i(r).pipe(p(400))}getLowStockProducts(){let t=this.products.filter(e=>e.stock<=e.minStockLevel).map(e=>({name:e.name,stock:e.stock})).slice(0,5);return i(t).pipe(p(300))}getExpiringProducts(){let t=new Date,e=new Date;e.setMonth(t.getMonth()+3);let r=this.products.filter(n=>n.expirationDate<=e&&n.expirationDate>=t).map(n=>({name:n.name,expirationDate:n.expirationDate})).sort((n,h)=>n.expirationDate.getTime()-h.expirationDate.getTime()).slice(0,5);return i(r).pipe(p(300))}getExpiringSoonCount(){let t=new Date,e=new Date;return e.setMonth(t.getMonth()+3),this.products.filter(r=>r.expirationDate<=e&&r.expirationDate>=t).length}};a.\u0275fac=(()=>{let t;return function(r){return(t||(t=D(a)))(r||a)}})(),a.\u0275prov=d({token:a,factory:a.\u0275fac,providedIn:"root"});let o=a;return o})();var q=(()=>{let a=class a{};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=R({type:a,selectors:[["app-root"]],decls:1,vars:0,template:function(e,r){e&1&&L(0,"router-outlet")},dependencies:[$,j],encapsulation:2});let o=a;return o})();O(q,{providers:[V(H),B(),{provide:S,useClass:z},{provide:k,useClass:J},{provide:E,useClass:Y},{provide:x,useClass:K},{provide:T,useClass:Q},{provide:P,useClass:X}]});export{q as App};
